# Event Queue Pattern 

## インテント

メッセージやイベントが送信されるタイミングと、それが処理されるタイミングを切り離す。




## パターン

キューは、一連の通知やリクエストを先入れ先出しで保存します。通知を送ると、リクエストはキューに入れられ、戻ってきます。そして、リクエスト処理系は、後日、キューからアイテムを処理します。リクエストは直接処理することもできるし、関係者にルーティングすることもできる。これにより、送り手と受け手が静的にも時間的にも切り離されます。





## いつ使うか

メッセージの送信者と受信者を分離したいだけなら、Observer や Command のようなパターンを使えば、それほど複雑なことはせずに済みます。キューが必要なのは、時間的に何かを切り離したいときだけです。

このことはほぼすべての章で触れていますが、強調する価値があります。複雑だとスピードが落ちるので、シンプルさは貴重な資源として扱いましょう。

私はこれを「押し引き」という言葉で考えています。あるコードAが、別のチャンクBに何らかの作業をさせることを望んでいるとします。AがBに要求を出すのは自然なことです。

一方、Bがその要求を処理するためには、実行サイクルの都合の良いタイミングで要求を引き込むのが自然な方法です。一方にプッシュ型、もう一方にプル型がある場合、その間にバッファが必要です。これが、キューが提供する、より単純なデカップリングパターンにはないものです。

キューは、そこからプルするコードに制御を与えます。レシーバは、処理を遅らせたり、リクエストを集約したり、完全に破棄したりすることができます。しかし、キューは送り手から制御を奪うことでこれを実現します。送信者ができることは、キューにリクエストを放り込んで、ベストを尽くすことだけです。このため、送信者が応答を必要とする場合には、キューはあまり適しません。



## Tips

Unityエンジンの主要な設計は、このコンポーネントモデルに基づいています。
